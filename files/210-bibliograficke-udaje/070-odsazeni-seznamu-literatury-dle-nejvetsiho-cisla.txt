anchor-name:bibnumindent
id:0040
author:P. O.
date:2014-04-01

----lang:cs--title:Odsazení seznamu literatury dle největšího čísla
OPmac ignoruje údaj generovaný BibTeXem o počtu cifer největšího čísla v
seznamu literatury, protože jednak umožňuje seznam také vytvořit pomocí
příkazů `\bib` mimo BibTeX, a dále při využití jednou generované databáze pro
více účelů nemusí být údaj generovaný BibTeXem pravdivý. Místo toho OPmac
zavádí makro `\lastbibnum`, které po přečtení REF souboru obsahuje největší
číslo v seznamu literatury. Implicitně toto makro není nijak využito, ale
můžete ho při formátování seznamu literatury použít. Například takto:

```
\def\printbib{%
   \ifx\lastbibnum\undefined \tmpdim=\iindent
   \else \setbox0=\hbox{[\lastbibnum] }%
      \ifdim \parindent=0pt \tmpdim=\wd0
      \else \tmpdim=0pt \loop \advance\tmpdim by\parindent
                              \ifdim\tmpdim<\wd0 \repeat
   \fi\fi
   \hangindent=\tmpdim \noindent \hskip\tmpdim \llap{[\the\bibnum] }%
}
```

Zde je předefinováno formátovací makro `\printbib`, které si změří box
obsahující `[\lastbibnum]~`. Při nulovém `\parindent` nastaví `\tmpdim` na
šířku tohoto boxu a při nenulovém `\parindent` nastaví `\tmpdim` na násobek
`\parindent` tak, aby se box do vzniklé mezery vešel. Pak odsadí
bibloigrafický záznam podle `\tmpdim`.

----lang:en--title:Bibliography indentation by maximal cite number
OPmac ignores the item (generated by BibTeX) about the number of digits of
the maximal number in the bibliography list. The reason is that OPmac
provides to assemble the bibliography list by `\bib` sequences outside BibTeX
and it provides the usage of pre-generated databases in various form and the
BibTeX-generated value cannot be exactly true. OPmac introduces the
`\lastbibnum` which includes the maximal number in the bibliography list after
REF file is read. By default this value isn't used but you can use this when
you design the format of bibliography list. For example:

```
\def\printbib{%
   \ifx\lastbibnum\undefined \tmpdim=\iindent
   \else \setbox0=\hbox{[\lastbibnum] }%
      \ifdim \parindent=0pt \tmpdim=\wd0
      \else \tmpdim=0pt \loop \advance\tmpdim by\parindent
                              \ifdim\tmpdim<\wd0 \repeat
   \fi\fi
   \hangindent=\tmpdim \noindent \hskip\tmpdim \llap{[\the\bibnum] }%
}
```

The format-making macro `\printbib` is redefined here. It measures the box
with the `[\lastbibnum]~`. If `\parindent` is zero then `\tmpdim` is set to
the width of this box else `\tmpdim` is set to the multiply of the `\parindent`
so, that the box fits into the generated space. The bibliography list is
indented by `\tmpdim`.
